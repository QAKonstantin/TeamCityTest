{"uid":"8387e87c7ba90491","name":"Авторизация под разными ролями и проверка ссылок в футере","fullName":"tests.frontend.test_check_footer#test_e2e_check_footer_by_roles","historyId":"9f36a7653b9c32aae141b627f1dd1145","time":{"start":1711352559978,"stop":1711352625041,"duration":65063},"status":"broken","statusMessage":"ValueError: Unexpected status code: 403, expected: 204","statusTrace":"self = <allure_commons._allure.fixture object at 0x7fa73c9306a0>, args = ()\nkwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        self.parameters = func_parameters(self._fixture_function, *args, **kwargs)\n    \n        with self:\n>           return self._fixture_function(*args, **kwargs)\n\n../../../.local/lib/python3.10/site-packages/allure_commons/_allure.py:221: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nconftest.py:74: in user_create\n    super_admin.api_manager.user_api.delete_user(username)\napi/user_api.py:12: in delete_user\n    return self.send_request(\"DELETE\", f\"/app/rest/users/{user_locator}\",\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <api.user_api.UserApi object at 0x7fa73c9301f0>, method = 'DELETE'\nendpoint = '/app/rest/users/again', data = None\nexpected_status = <HTTPStatus.NO_CONTENT: 204>, need_logging = True\nneed_verify_status = True\n\n    def send_request(self, method, endpoint, data=None, expected_status=HTTPStatus.OK, need_logging=True,\n                     need_verify_status=True):\n        \"\"\"\n        Врапер для запросов. Позволяет прикручивать дополнительную логику\n        :param method: Метод запроса\n        :param endpoint: Ендпоинт для склейки с BASE_URL\n        :param data: Тело запроса. По умолчанию пустое, чтобы пропускало no-content запросы\n        :param expected_status: Ожидаемый статус код\n        :param need_logging: Флаг для логирования. По умолчанию = True\n        :param need_verify_status: Флаг для проверки статус кода в ответе. По умолчанию = True\n        :return: Возвращает объект ответа\n        \"\"\"\n        url = f\"{self.base_url}{endpoint}\"\n        response = self.session.request(method=method, url=url, json=data)\n        if need_logging:\n            self.log_request_and_response(response, expected_status, need_verify_status)\n        if need_verify_status:\n            if response.status_code != expected_status:\n>               raise ValueError(f\"Unexpected status code: {response.status_code}, expected: {expected_status}\")\nE               ValueError: Unexpected status code: 403, expected: 204\n\ncustom_requester/custom_requester.py:34: ValueError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1711352418371,"stop":1711352418438,"duration":67},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1711352542607,"stop":1711352559959,"duration":17352},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"user_session","time":{"start":1711352559959,"stop":1711352559961,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"super_admin","time":{"start":1711352559961,"stop":1711352559972,"duration":11},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"user_create","time":{"start":1711352559974,"stop":1711352559974,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"ValueError: Unexpected status code: 403, expected: 204","statusTrace":"self = <allure_commons._allure.fixture object at 0x7fa73c9306a0>, args = ()\nkwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        self.parameters = func_parameters(self._fixture_function, *args, **kwargs)\n    \n        with self:\n>           return self._fixture_function(*args, **kwargs)\n\n../../../.local/lib/python3.10/site-packages/allure_commons/_allure.py:221: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nconftest.py:74: in user_create\n    super_admin.api_manager.user_api.delete_user(username)\napi/user_api.py:12: in delete_user\n    return self.send_request(\"DELETE\", f\"/app/rest/users/{user_locator}\",\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <api.user_api.UserApi object at 0x7fa73c9301f0>, method = 'DELETE'\nendpoint = '/app/rest/users/again', data = None\nexpected_status = <HTTPStatus.NO_CONTENT: 204>, need_logging = True\nneed_verify_status = True\n\n    def send_request(self, method, endpoint, data=None, expected_status=HTTPStatus.OK, need_logging=True,\n                     need_verify_status=True):\n        \"\"\"\n        Врапер для запросов. Позволяет прикручивать дополнительную логику\n        :param method: Метод запроса\n        :param endpoint: Ендпоинт для склейки с BASE_URL\n        :param data: Тело запроса. По умолчанию пустое, чтобы пропускало no-content запросы\n        :param expected_status: Ожидаемый статус код\n        :param need_logging: Флаг для логирования. По умолчанию = True\n        :param need_verify_status: Флаг для проверки статус кода в ответе. По умолчанию = True\n        :return: Возвращает объект ответа\n        \"\"\"\n        url = f\"{self.base_url}{endpoint}\"\n        response = self.session.request(method=method, url=url, json=data)\n        if need_logging:\n            self.log_request_and_response(response, expected_status, need_verify_status)\n        if need_verify_status:\n            if response.status_code != expected_status:\n>               raise ValueError(f\"Unexpected status code: {response.status_code}, expected: {expected_status}\")\nE               ValueError: Unexpected status code: 403, expected: 204\n\ncustom_requester/custom_requester.py:34: ValueError","steps":[{"name":"Создание пользователя с ролью AGENT_MANAGER","time":{"start":1711352559978,"stop":1711352560051,"duration":73},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Авторизация под ролью AGENT_MANAGER","time":{"start":1711352560051,"stop":1711352586981,"duration":26930},"status":"passed","steps":[{"name":"Переход на страницу авторизации","time":{"start":1711352560051,"stop":1711352570562,"duration":10511},"status":"passed","steps":[{"name":"Переход на URL: http://localhost:8111/login.html","time":{"start":1711352560051,"stop":1711352570526,"duration":10475},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ожидание загрузки страницы","time":{"start":1711352570526,"stop":1711352570562,"duration":36},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Ввод данных для авторизации","time":{"start":1711352570562,"stop":1711352574100,"duration":3538},"status":"passed","steps":[{"name":"Ожидаем появления элемента: #username","time":{"start":1711352570562,"stop":1711352571921,"duration":1359},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ввод текста again в элемент: #username","time":{"start":1711352571921,"stop":1711352573067,"duration":1146},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ввод текста CGXZXBLaP5p в элемент: #password","time":{"start":1711352573067,"stop":1711352574100,"duration":1033},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Авторизация пользователя","time":{"start":1711352574100,"stop":1711352576240,"duration":2140},"status":"passed","steps":[{"name":"Клик по элементу: .loginButton","time":{"start":1711352574100,"stop":1711352576240,"duration":2140},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Ожидание изменения URL на http://localhost:8111/favorite/projects","time":{"start":1711352576240,"stop":1711352586981,"duration":10741},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":10,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Проверка ссылок в футере","time":{"start":1711352586981,"stop":1711352623602,"duration":36621},"status":"passed","steps":[{"name":"Проверка активности кнопки: span.ring-link-inner:has-text('About TeamCity')","time":{"start":1711352586981,"stop":1711352597231,"duration":10250},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Клик по элементу: span.ring-link-inner:has-text('About TeamCity')","time":{"start":1711352597231,"stop":1711352599787,"duration":2556},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ожидание загрузки страницы","time":{"start":1711352599787,"stop":1711352599833,"duration":46},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка, что ссылка открылась в новой вкладке","time":{"start":1711352599833,"stop":1711352616984,"duration":17151},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Закрыть вкладку","time":{"start":1711352616984,"stop":1711352617029,"duration":45},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка активности кнопки: span.ring-link-inner:has-text('License Agreement')","time":{"start":1711352617029,"stop":1711352617852,"duration":823},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Клик по элементу: span.ring-link-inner:has-text('License Agreement')","time":{"start":1711352617852,"stop":1711352618863,"duration":1011},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ожидание загрузки страницы","time":{"start":1711352618863,"stop":1711352618886,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка, что ссылка открылась в новой вкладке","time":{"start":1711352618886,"stop":1711352622383,"duration":3497},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Закрыть вкладку","time":{"start":1711352622383,"stop":1711352623602,"duration":1219},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":10,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Проверка версии системы","time":{"start":1711352623602,"stop":1711352624632,"duration":1030},"status":"passed","steps":[{"name":"Получить текст по локатору: div[title='Node id: MAIN_SERVER']","time":{"start":1711352623602,"stop":1711352624632,"duration":1030},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Проверка копирайта","time":{"start":1711352624632,"stop":1711352625041,"duration":409},"status":"passed","steps":[{"name":"Получить текст по локатору: div.Footer__copyright--Pt","time":{"start":1711352624632,"stop":1711352625041,"duration":409},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"6fcf75169f6a8823","name":"log","source":"6fcf75169f6a8823.txt","type":"text/plain","size":1868}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":27,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"user_create::0","time":{"start":1711352625045,"stop":1711352625058,"duration":13},"status":"broken","statusMessage":"ValueError: Unexpected status code: 403, expected: 204\n","statusTrace":"  File \"/home/runner/.local/lib/python3.10/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n  File \"/home/runner/.local/lib/python3.10/site-packages/_pytest/fixtures.py\", line 932, in _teardown_yield_fixture\n    next(it)\n  File \"/home/runner/work/TeamCity_Test/TeamCity_Test/conftest.py\", line 74, in user_create\n    super_admin.api_manager.user_api.delete_user(username)\n  File \"/home/runner/work/TeamCity_Test/TeamCity_Test/api/user_api.py\", line 12, in delete_user\n    return self.send_request(\"DELETE\", f\"/app/rest/users/{user_locator}\",\n  File \"/home/runner/work/TeamCity_Test/TeamCity_Test/custom_requester/custom_requester.py\", line 34, in send_request\n    raise ValueError(f\"Unexpected status code: {response.status_code}, expected: {expected_status}\")\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"user_session::0","time":{"start":1711352625062,"stop":1711352625065,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1711352644996,"stop":1711352646863,"duration":1867},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"subSuite","value":"Футер"},{"name":"parentSuite","value":"UI тесты"},{"name":"severity","value":"normal"},{"name":"suite","value":"Проверка футера"},{"name":"tag","value":"footer"},{"name":"host","value":"fv-az881-570"},{"name":"thread","value":"7939-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.frontend.test_check_footer"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser","value":"'firefox'"},{"name":"role","value":"'AGENT_MANAGER'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":8,"unknown":0,"total":9},"items":[{"uid":"51817f606eeb1db7","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/111//#testresult/51817f606eeb1db7","status":"passed","time":{"start":1711351828475,"stop":1711351868857,"duration":40382}},{"uid":"18e83b38133e8ef3","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/110//#testresult/18e83b38133e8ef3","status":"passed","time":{"start":1711351097672,"stop":1711351119055,"duration":21383}},{"uid":"1e69a43ebb5e8be4","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/109//#testresult/1e69a43ebb5e8be4","status":"passed","time":{"start":1711349231614,"stop":1711349258526,"duration":26912}},{"uid":"25d9b31407f42309","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/107//#testresult/25d9b31407f42309","status":"passed","time":{"start":1711348567703,"stop":1711348596944,"duration":29241}},{"uid":"5ef986a929bc3b8c","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/106//#testresult/5ef986a929bc3b8c","status":"passed","time":{"start":1711305546930,"stop":1711305571067,"duration":24137}},{"uid":"85e9b6c29b62309","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/105//#testresult/85e9b6c29b62309","status":"passed","time":{"start":1711304790432,"stop":1711304821658,"duration":31226}},{"uid":"768f190258415a79","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/104//#testresult/768f190258415a79","status":"passed","time":{"start":1711303864081,"stop":1711303890610,"duration":26529}},{"uid":"11236db64b7eb046","reportUrl":"https://QAKonstantin.github.io/TeamCity_Test/103//#testresult/11236db64b7eb046","status":"passed","time":{"start":1711303094161,"stop":1711303115598,"duration":21437}}]},"tags":["footer"]},"source":"8387e87c7ba90491.json","parameterValues":["'firefox'","'AGENT_MANAGER'"]}